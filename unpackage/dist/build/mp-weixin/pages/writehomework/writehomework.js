"use strict";var e=require("../../common/vendor.js");const t={data:()=>({title:"",datetimesingle:"",content:"",imageValue:[],ifUpload:!1,imagesNum:0}),methods:{async upImagesOver(){const t=e.index.getStorageSync("userAccount"),i=e.hooks().format("YYYY-MM-DD hh:mm:ss"),o=new Array;for(let e=0;e<this.imageValue.length;e++)o.push(this.imageValue[e].url);const n={title:this.title,author:t,time:i,deadLine:this.datetimesingle,content:this.content,images:o,completeUsers:new Array,notCompleteUsers:new Array},a=e.pn.database();await a.collection("homework").add(n),e.index.showModal({title:"成功",content:"发布成功",showCancel:!1,success(){e.index.reLaunch({url:"/pages/homework/homework"})}}),this.ifUpload=!1},sendHomework(){this.ifUpload=!0,""===this.title||""===this.datetimesingle||""===this.content?(e.index.showToast({title:"请完整填写表单",icon:"error",duration:2e3}),this.ifUpload=!1):this.imagesNum>0?this.$refs.files.upload():this.upImagesOver()},addImage(e){0===e?this.imagesNum+=1:this.imagesNum-=1}}};if(!Array){(e.resolveComponent("uni-section")+e.resolveComponent("uni-datetime-picker")+e.resolveComponent("uni-file-picker"))()}Math||((()=>"../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker.js")+(()=>"../../uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.js"))();var i=e._export_sfc(t,[["render",function(t,i,o,n,a,s){return e.e({a:a.title,b:e.o((e=>a.title=e.detail.value)),c:e.p({title:"标题(科目)",type:"line"}),d:e.o((e=>a.datetimesingle=e)),e:e.p({type:"datetime",modelValue:a.datetimesingle}),f:e.p({title:"截止日期",type:"line"}),g:a.content,h:e.o((e=>a.content=e.detail.value)),i:e.sr("files","3a0e719f-4,3a0e719f-3"),j:e.o(s.upImagesOver),k:e.o((e=>s.addImage(0))),l:e.o((e=>s.addImage(1))),m:e.o((e=>a.imageValue=e)),n:e.p({limit:"9",title:"最多选择9张图片",fileMediatype:"image","file-extname":"jpg,png","auto-upload":!1,modelValue:a.imageValue}),o:a.ifUpload},a.ifUpload?{}:{p:e.o(((...e)=>s.sendHomework&&s.sendHomework(...e)))},{q:e.p({title:"作业内容",type:"line"})})}]]);wx.createPage(i);
